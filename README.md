# 源码云功能

## 一、介绍

### 1.简介

源码云功能是针对编程猫源码云功能（云变量、云列表等）的客户端 Coco 控件。

### 2.主要功能

- 获取、修改作品云变量；
- 获取在线人数；
- 获取当前登录的用户信息；
- 获取、修改作品云列表。

### 3.其他

- 该控件的默认配置尽可能地与源码编辑器保持一致。

## 二、使用方法

### 1.导入到 CoCo

点击 [这里](https://greasyfork.org/zh-CN/scripts/450313-coco%E7%82%B9%E9%B8%AD%E6%8E%A7%E4%BB%B6%E5%95%86%E5%9F%8E) 安装点鸭控件商城，然后打开 CoCo 从点鸭控件商城导入该控件。

### 2.检测用户登陆状态

所有操作必须在登录编程猫账号的状态下进行。

### 3.连接到云

在进行除获取当前登录的用户信息之外的任何操作都需要在连接到云后进行。

使用`连接 到 (0)`积木进行连接，其中`(0)`为要连接的作品的 ID。

注意：
- 连接过程是同步执行的，这意味着当连接积木后的积木被执行时，连接处于完成或出错状态。
- 连接云时需要处在未连接状态，如果存在连接，上一个连接会自动断开。
- 由于云列表的特殊性，需要额外的初始化。

### 4.自动重连

当连接异常断开时，如果允许，会自动重连，否则会触发事件：连接出现异常。

### 5.本地预更新

用通俗的话来讲就是将云数据模拟为本地数据。

由于数据上传有延迟，本地更新后不可能立即在云端也更新。本地预更新则在本地更新时立即更新本地的值，而不是等到数据上传成功后在更新。

本地预更新假定每次本地更新时其他用户没有修改云端数据，如果假定不成立，则会修正数据使其符合实际情况。

### 6.云数据操作

云数据操作与源码编辑器相似，此处不再说明。数字会自动转换。
